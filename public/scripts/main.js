function setupPlayerOption(){function o(){var o=Math.floor(3*Math.random())+1,e=Math.floor(3*Math.random())+1,t=document.querySelector("#r"+o+"c"+e);t.classList.add("x")}var e=function(){for(var e=document.querySelectorAll(".game button"),t=0;t<e.length;t++)e[t].classList.remove("reset");bot=this.classList.contains("x")?"o":"x",player="x"===bot?"o":"x";var r=document.querySelector(".game");r.classList.remove("off"),r.classList.add("on");var n=document.querySelector(".status");n.innerText="Game on","x"===bot&&o()},t=document.querySelectorAll(".player");t[0].onclick=e,t[1].onclick=e}function setupPlayerInput(){function o(){result="Game on",positions=a(),winner=i(positions),winner?(s(winner),result=winner[0]==bot?"Bot ("+bot+") wins.":"You ("+player+") win!",window.setTimeout(e,3e3)):t()&&(result="It's a tie!",window.setTimeout(e,3e3));var o=document.querySelector(".status");return o.innerText=result,result}function e(){bot="b",player="b";var o=document.querySelector(".game");o.classList.remove("on"),o.classList.add("off");for(var e=document.querySelectorAll(".game button"),t=0;t<e.length;t++)e[t].classList.add("reset"),e[t].classList.remove("x"),e[t].classList.remove("o"),e[t].classList.remove("win")}function t(){return positions=a(),winner=i(positions),!winner&&!positions.toString().includes("b")}function n(){positions=a();var o=[bot+bot+"b",bot+"b"+bot,"b"+bot+bot],e=l(positions,o);if(console.log("fill "+e+" to win."),e);else{var t=[player+player+"b",player+"b"+player,"b"+player+player];if(e=l(positions,t),console.log("fill "+e+" to defend"),e);else{var r=[bot+"bb","bb"+bot,"b"+bot+"b"];if(e=l(positions,r),console.log("fill "+e+" to position strategically"),e);else{var n=[player+"bb","bb"+player,"b"+player+"b"];if(e=l(positions,n),console.log("fill "+e+" to position next to player"),e);else{var s=[player+"b"+bot,bot+"b"+player,"b"+player+bot,"b"+bot+player,bot+player+"b",player+bot+"b"];e=l(positions,s),console.log("fill "+e+" to cover last position")}}}}}function s(o){if(o[1]==o[3]||o[2]==o[4])for(var e=o[1];e<=o[3];e++)for(var t=o[2];t<=o[4];t++){var r=document.querySelector("#r"+e+"c"+t);r.classList.add("win")}else if(1==o[1]&&3==o[2])for(var n=1;n<4;n++){var r=document.querySelector("#r"+n+"c"+(4-n));r.classList.add("win")}else if(1==o[1]&&1==o[2])for(var n=1;n<4;n++){var r=document.querySelector("#r"+n+"c"+n);r.classList.add("win")}}function l(o,e){console.log("patterns: "+e);for(var t=!1,n=0;n<3;n++){var s=o[0][n]+o[1][n]+o[2][n];e.includes(o[n])?(c=o[n].indexOf("b")+1,r=n+1,t=[r,c]):e.includes(s)&&(r=s.indexOf("b")+1,c=n+1,t=[r,c])}var l=o[0][0]+o[1][1]+o[2][2],i=o[0][2]+o[1][1]+o[2][0];if(e.includes(l)){var a=l.indexOf("b");r=a+1,c=a+1,t=[r,c]}else if(e.includes(i)){var a=i.indexOf("b");c=3-a,r=a+1,t=[r,c]}if(console.log("after diagonal check result:"+t),t){console.log("findbestslot:trying to fill slot");var u=document.querySelector("#r"+t[0]+"c"+t[1]);u.classList.add(bot)}return t}function i(o){for(var e=!1,t=0;t<3;t++){var r=o[0][t]+o[1][t]+o[2][t];if("xxx"===o[t]?e=["x",t+1,1,t+1,3]:"ooo"===o[t]?e=["o",t+1,1,t+1,3]:"xxx"===r?e=["x",1,t+1,3,t+1]:"ooo"===r&&(e=["o",1,t+1,3,t+1]),e)break}var n=o[0][0]+o[1][1]+o[2][2],s=o[0][2]+o[1][1]+o[2][0];return e||("xxx"===n?e=["x",1,1,3,3]:"xxx"===s?e=["x",1,3,3,1]:"ooo"===n?e=["o",1,1,3,3]:"ooo"===s&&(e=["0",1,3,3,1])),e}function a(){for(var o=[],e=1;e<4;e++){for(var t="",r=1;r<4;r++){var n=document.querySelector("#r"+e+"c"+r);t+=n.classList.contains("x")?"x":n.classList.contains("o")?"o":"b"}o.push(t)}return o}for(var u=document.querySelectorAll(".game button"),b=function(){var e=a(),t=i(e);t||this.classList.contains("x")||this.classList.contains("o")||this.classList.add(player);var r=o();console.log("game status after user input: "+r),"Game on"==r&&(n(),o())},f=0;f<u.length;f++)u[f].onclick=b}var player="b",bot="b";document.addEventListener("DOMContentLoaded",function(o){setupPlayerOption(),setupPlayerInput()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsic2V0dXBQbGF5ZXJPcHRpb24iLCJmaXJzdE1vdmUiLCJyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiYyIsInJhbmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJhZGQiLCJwbGF5ZXJDaG9pY2UiLCJidXR0b25zIiwicXVlcnlTZWxlY3RvckFsbCIsImkiLCJsZW5ndGgiLCJyZW1vdmUiLCJib3QiLCJ0aGlzIiwiY29udGFpbnMiLCJwbGF5ZXIiLCJnYW1lIiwic3RhdHVzIiwiaW5uZXJUZXh0IiwicGxheWVyT3B0aW9ucyIsIm9uY2xpY2siLCJzZXR1cFBsYXllcklucHV0IiwiZXZhbHVhdGVHYW1lU3RhdHVzIiwicmVzdWx0IiwicG9zaXRpb25zIiwiZ2V0R2FtZVBvc2l0aW9ucyIsIndpbm5lciIsImdldFdpbm5lciIsImZvcm1hdFdpbm5lciIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJyZXNldEdhbWUiLCJnYW1lVGllIiwidG9TdHJpbmciLCJpbmNsdWRlcyIsImJvdFJlc3BvbnNlIiwid2luUGF0dGVybnMiLCJuZXh0IiwiZmlsbE5leHRCZXN0U2xvdCIsImNvbnNvbGUiLCJsb2ciLCJkZWZlbmNlUGF0dGVybnMiLCJzdHJhdGVnaWNXaW5QYXR0ZXJucyIsInN0cmF0ZWdpY0RlZmVuY2VQYXR0ZXJucyIsIm9uZUxhc3RTbG90UGF0dGVybnMiLCJibG9jayIsInBhdHRlcm5zIiwiY29sdW1uIiwiaW5kZXhPZiIsImRpYWcxIiwiZGlhZzIiLCJpbmRleCIsIm5leHRCbG9jayIsImdhbWVQb3NpdGlvbnMiLCJyb3ciLCJqIiwicG9zaXRpb24iLCJwdXNoIiwiYnV0dG9uQ2xpY2tIYW5kbGVyIiwiZ2FtZVN0YXR1cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIl0sIm1hcHBpbmdzIjoiQUFhQSxRQUFTQSxxQkFpQlAsUUFBU0MsS0FDUCxHQUFJQyxHQUFFQyxLQUFLQyxNQUFvQixFQUFk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QyxHQUNmaUIsU0FBUUMsSUFBSSxpQ0FBbUNtQixHQUNoQyxXQUFaQSxJQUNEeEIsSUFDQWIsTUFzT0liLEVBQUUsRUFBRUEsRUFBRUYsRUFBUUcsT0FBT0QsSUFDM0JGLEVBQVFFLEdBQUdXLFFBQVFzQyxFQW5TckIsR0FBSTNDLFFBQU8sSUFDUEgsSUFBSSxHQUNWVixVQUFTMEQsaUJBQWlCLG1CQUFtQixTQUFTQyxHQUlwRG5FLG9CQUNBMkIiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICAqIHdhaXQgdW50aWwgdGhlIGRvYyBpcyByZWFkeSB0byBvYmV5IG9yZGVyc1xuICAqL1xuICB2YXIgcGxheWVyPVwiYlwiO1xuICB2YXIgYm90PVwiYlwiO1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIixmdW5jdGlvbihlKXtcbiAgLyoqXG4gICAgKiBvbmNlIGNvbnRlbnQgaXMgbG9hZGVkXG4gICAgKi9cbiAgc2V0dXBQbGF5ZXJPcHRpb24oKTtcbiAgc2V0dXBQbGF5ZXJJbnB1dCgpO1xufSk7XG5cbmZ1bmN0aW9uIHNldHVwUGxheWVyT3B0aW9uKCl7XG4gIHZhciBwbGF5ZXJDaG9pY2U9ZnVuY3Rpb24oKXtcbiAgICB2YXIgYnV0dG9ucz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmdhbWUgYnV0dG9uXCIpO1xuICAgIGZvcih2YXIgaT0wO2k8YnV0dG9ucy5sZW5ndGg7aSsrKXtcbiAgICAgIGJ1dHRvbnNbaV0uY2xhc3NMaXN0LnJlbW92ZShcInJlc2V0XCIpO1xuICAgIH1cbiAgICBib3Q9KHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKFwieFwiKSkgPyBcIm9cIiA6IFwieFwiO1xuICAgIHBsYXllcj0oYm90PT09XCJ4XCIpID8gXCJvXCIgOiBcInhcIjtcbiAgICB2YXIgZ2FtZT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FtZScpO1xuICAgIGdhbWUuY2xhc3NMaXN0LnJlbW92ZSgnb2ZmJyk7XG4gICAgZ2FtZS5jbGFzc0xpc3QuYWRkKCdvbicpO1xuICAgIHZhciBzdGF0dXM9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0YXR1cycpO1xuICAgIHN0YXR1cy5pbm5lclRleHQ9XCJHYW1lIG9uXCI7XG4gICAgaWYoYm90PT09XCJ4XCIpXG4gICAgICBmaXJzdE1vdmUoKTtcbiAgfTtcblxuICBmdW5jdGlvbiBmaXJzdE1vdmUoKXtcbiAgICB2YXIgcj1NYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMykrMTtcbiAgICB2YXIgYz1NYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMykrMTtcbiAgICB2YXIgcmFuZD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JcIisgciArIFwiY1wiICtjKTtcbiAgICByYW5kLmNsYXNzTGlzdC5hZGQoXCJ4XCIpO1xuICB9O1xuXG4gIHZhciBwbGF5ZXJPcHRpb25zPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wbGF5ZXInKTtcbiAgcGxheWVyT3B0aW9uc1swXS5vbmNsaWNrPXBsYXllckNob2ljZTtcbiAgcGxheWVyT3B0aW9uc1sxXS5vbmNsaWNrPXBsYXllckNob2ljZTtcblxufVxuXG5mdW5jdGlvbiBzZXR1cFBsYXllcklucHV0KCl7XG4gIHZhciBidXR0b25zPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZ2FtZSBidXR0b25cIik7XG4gIHZhciBidXR0b25DbGlja0hhbmRsZXI9ZnVuY3Rpb24oKXtcbiAgICB2YXIgcG9zaXRpb25zPWdldEdhbWVQb3NpdGlvbnMoKTtcbiAgICB2YXIgd2lubmVyPWdldFdpbm5lcihwb3NpdGlvbnMpO1xuICAgIC8vIGRvIG5vdGhpbmcgaWYgdGhlIGJsb2NrIGFscmVhZHkgaGFzIHggb3IgbyAoYW5kIHRoZSBnYW1lIGlzIHN0aWxsIG9uKVxuICAgIGlmKCF3aW5uZXIgJiYgIXRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKFwieFwiKSAmJiAhdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoXCJvXCIpKXtcbiAgICAgIHRoaXMuY2xhc3NMaXN0LmFkZChwbGF5ZXIpO1xuICAgIH1cbiAgICAvKnBvc2l0aW9ucz1nZXRHYW1lUG9zaXRpb25zKCk7IC8vZ2V0IHBvc2l0aW9ucyBhZ2FpbiwgYmFzZWQgb24gbGFzdCB1c2VyIGlucHV0XG4gICAgd2lubmVyPWdldFdpbm5lcihwb3NpdGlvbnMpO1xuICAgIGNvbnNvbGUubG9nKHdpbm5lcik7XG4gICAgaWYod2lubmVyKXtcbiAgICAgIGZvcm1hdFdpbm5lcih3aW5uZXIpO1xuICAgICAgcmV0dXJuOyAvL2dhbWVvdmVyXG4gICAgfSovXG4gICAgdmFyIGdhbWVTdGF0dXM9ZXZhbHVhdGVHYW1lU3RhdHVzKCk7IC8vZm9yIHVzZXIgaW5wdXRcbiAgICBjb25zb2xlLmxvZyhcImdhbWUgc3RhdHVzIGFmdGVyIHVzZXIgaW5wdXQ6IFwiICsgZ2FtZVN0YXR1cyk7XG4gICAgaWYoZ2FtZVN0YXR1cz09XCJHYW1lIG9uXCIpe1xuICAgICAgYm90UmVzcG9uc2UoKTtcbiAgICAgIGV2YWx1YXRlR2FtZVN0YXR1cygpOyAvL2ZvciBib3QgcmVzcG9uc2VcbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gZXZhbHVhdGVHYW1lU3RhdHVzKCl7XG4gICAgcmVzdWx0PVwiR2FtZSBvblwiO1xuICAgIHBvc2l0aW9ucz1nZXRHYW1lUG9zaXRpb25zKCk7IC8vZ2V0IHBvc2l0aW9ucyBhZ2FpbiwgYmFzZWQgb24gbGFzdCB1c2VyIGlucHV0XG4gICAgd2lubmVyPWdldFdpbm5lcihwb3NpdGlvbnMpO1xuICAgIGlmKHdpbm5lcil7XG4gICAgICBmb3JtYXRXaW5uZXIod2lubmVyKTtcbiAgICAgIHJlc3VsdD0od2lubmVyWzBdPT1ib3QpPyBcIkJvdCAoXCIrIGJvdCArIFwiKSB3aW5zLlwiIDogXCJZb3UgKFwiICsgcGxheWVyICsgXCIpIHdpbiFcIjtcbiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHJlc2V0R2FtZSwzMDAwKTtcbiAgICB9ZWxzZSBpZiAoZ2FtZVRpZSgpKXtcbiAgICAgIHJlc3VsdD1cIkl0J3MgYSB0aWUhXCI7XG4gICAgICB3aW5kb3cuc2V0VGltZW91dChyZXNldEdhbWUsMzAwMCk7XG4gICAgfVxuICAgIHZhciBzdGF0dXM9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN0YXR1cycpO1xuICAgIHN0YXR1cy5pbm5lclRleHQ9cmVzdWx0O1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBmdW5jdGlvbiByZXNldEdhbWUoKXtcbiAgICBib3Q9XCJiXCI7XG4gICAgcGxheWVyPVwiYlwiO1xuICAgIHZhciBnYW1lPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYW1lJyk7XG4gICAgZ2FtZS5jbGFzc0xpc3QucmVtb3ZlKCdvbicpO1xuICAgIGdhbWUuY2xhc3NMaXN0LmFkZCgnb2ZmJyk7XG4gICAgdmFyIGJ1dHRvbnM9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5nYW1lIGJ1dHRvblwiKTtcbiAgICBmb3IodmFyIGk9MDtpPGJ1dHRvbnMubGVuZ3RoO2krKyl7XG4gICAgICBidXR0b25zW2ldLmNsYXNzTGlzdC5hZGQoXCJyZXNldFwiKTtcbiAgICAgIGJ1dHRvbnNbaV0uY2xhc3NMaXN0LnJlbW92ZShcInhcIik7XG4gICAgICBidXR0b25zW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJvXCIpO1xuICAgICAgYnV0dG9uc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwid2luXCIpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdhbWVUaWUoKXtcbiAgICBwb3NpdGlvbnM9Z2V0R2FtZVBvc2l0aW9ucygpO1xuICAgIHdpbm5lcj1nZXRXaW5uZXIocG9zaXRpb25zKTtcbiAgICByZXR1cm4gKCF3aW5uZXIgJiYgIXBvc2l0aW9ucy50b1N0cmluZygpLmluY2x1ZGVzKFwiYlwiKSk7IC8vbm8gb25lIGhhcyB3b24gYW5kIG5vIGJsYW5rcztcbiAgfVxuICBmdW5jdGlvbiBib3RSZXNwb25zZSgpe1xuICAgIHBvc2l0aW9ucz1nZXRHYW1lUG9zaXRpb25zKCk7IC8vZ2V0IGN1cnJlbnQgZ2FtZSBwb3NpdGlvbnNcbiAgICB2YXIgd2luUGF0dGVybnM9W2JvdCtib3QrXCJiXCIsYm90K1wiYlwiK2JvdCxcImJcIitib3QrYm90XTtcbiAgICAvL3RyeSB0byB3aW4gZmlyc3RcbiAgICB2YXIgbmV4dD1maWxsTmV4dEJlc3RTbG90KHBvc2l0aW9ucyx3aW5QYXR0ZXJucyk7XG4gICAgY29uc29sZS5sb2coXCJmaWxsIFwiICsgbmV4dCArIFwiIHRvIHdpbi5cIik7XG4gICAgaWYobmV4dCl7XG4gICAgICAvKnZhciBuZXh0QmxvY2s9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNyXCIrbmV4dFswXStcImNcIituZXh0WzFdKTtcbiAgICAgIG5leHRCbG9jay5jbGFzc0xpc3QuYWRkKGJvdCk7Ki9cbiAgICAgIC8qcG9zaXRpb25zPWdldEdhbWVQb3NpdGlvbnMoKTtcbiAgICAgIHdpbm5lcj1nZXRXaW5uZXIocG9zaXRpb25zKTtcbiAgICAgIGNvbnNvbGUubG9nKFwid2lubmVyOlwiK3dpbm5lcik7XG4gICAgICBpZih3aW5uZXIpe1xuICAgICAgICBmb3JtYXRXaW5uZXIod2lubmVyKTtcbiAgICAgICAgcmV0dXJuOyAvL2dhbWVvdmVyXG4gICAgICB9Ki9cbiAgICB9ZWxzZXtcbiAgICAgIC8vc2Vjb25kIGlzIHRvIHRyeSBhbmQgZGVmZW5kXG4gICAgICB2YXIgZGVmZW5jZVBhdHRlcm5zPVtwbGF5ZXIrcGxheWVyK1wiYlwiLHBsYXllcitcImJcIitwbGF5ZXIsXCJiXCIrcGxheWVyK3BsYXllcl07XG4gICAgICBuZXh0PWZpbGxOZXh0QmVzdFNsb3QocG9zaXRpb25zLGRlZmVuY2VQYXR0ZXJucyk7XG4gICAgICBjb25zb2xlLmxvZyhcImZpbGwgXCIgKyBuZXh0ICsgXCIgdG8gZGVmZW5kXCIpO1xuICAgICAgaWYobmV4dCl7XG4gICAgICAgIC8qdmFyIG5leHRCbG9jaz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JcIituZXh0WzBdK1wiY1wiK25leHRbMV0pO1xuICAgICAgICBuZXh0QmxvY2suY2xhc3NMaXN0LmFkZChib3QpOyovXG4gICAgICB9ZWxzZXsgLy90aGlyZCwgdHJ5IHRvIHBvc2l0aW9uIGJvdCBzaWRlIGJ5IHNpZGUsIGluIHJlYWRpbmVzcyBmb3IgbmV4dCB3aW5cbiAgICAgICAgdmFyIHN0cmF0ZWdpY1dpblBhdHRlcm5zPVtib3QrXCJiYlwiLFwiYmJcIitib3QsXCJiXCIrYm90K1wiYlwiXTtcbiAgICAgICAgbmV4dD1maWxsTmV4dEJlc3RTbG90KHBvc2l0aW9ucyxzdHJhdGVnaWNXaW5QYXR0ZXJucyk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZmlsbCBcIiArIG5leHQgKyBcIiB0byBwb3NpdGlvbiBzdHJhdGVnaWNhbGx5XCIpO1xuICAgICAgICBpZihuZXh0KXtcbiAgICAgICAgICAvKnZhciBuZXh0QmxvY2s9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNyXCIrbmV4dFswXStcImNcIituZXh0WzFdKTtcbiAgICAgICAgICBuZXh0QmxvY2suY2xhc3NMaXN0LmFkZChib3QpOyovXG4gICAgICAgIH1lbHNleyAvL211c3QgYmUgZWFybHkgc3RhZ2VzLCB0cnkgdG8gcG9zaXRpb24gcmlnaHQgbmV4dCB0byB0aGUgcGxheWVyXG4gICAgICAgICAgdmFyIHN0cmF0ZWdpY0RlZmVuY2VQYXR0ZXJucz1bcGxheWVyK1wiYmJcIixcImJiXCIrcGxheWVyLFwiYlwiK3BsYXllcitcImJcIl07XG4gICAgICAgICAgbmV4dD1maWxsTmV4dEJlc3RTbG90KHBvc2l0aW9ucyxzdHJhdGVnaWNEZWZlbmNlUGF0dGVybnMpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiZmlsbCBcIiArIG5leHQgKyBcIiB0byBwb3NpdGlvbiBuZXh0IHRvIHBsYXllclwiKTtcbiAgICAgICAgICBpZihuZXh0KXtcbiAgICAgICAgICAgIC8qdmFyIG5leHRCbG9jaz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JcIituZXh0WzBdK1wiY1wiK25leHRbMV0pO1xuICAgICAgICAgICAgbmV4dEJsb2NrLmNsYXNzTGlzdC5hZGQoYm90KTsqL1xuICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgdmFyIG9uZUxhc3RTbG90UGF0dGVybnM9W1xuICAgICAgICAgICAgICBwbGF5ZXIrXCJiXCIrYm90LFxuICAgICAgICAgICAgICBib3QrXCJiXCIrcGxheWVyLFxuICAgICAgICAgICAgICBcImJcIitwbGF5ZXIrYm90LFxuICAgICAgICAgICAgICBcImJcIitib3QrcGxheWVyLFxuICAgICAgICAgICAgICBib3QrcGxheWVyK1wiYlwiLFxuICAgICAgICAgICAgICBwbGF5ZXIrYm90K1wiYlwiXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgbmV4dD1maWxsTmV4dEJlc3RTbG90KHBvc2l0aW9ucyxvbmVMYXN0U2xvdFBhdHRlcm5zKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZmlsbCBcIiArIG5leHQgKyBcIiB0byBjb3ZlciBsYXN0IHBvc2l0aW9uXCIpO1xuICAgICAgICAgICAgaWYobmV4dCl7XG4gICAgICAgICAgICAgIC8qdmFyIG5leHRCbG9jaz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JcIituZXh0WzBdK1wiY1wiK25leHRbMV0pO1xuICAgICAgICAgICAgICBuZXh0QmxvY2suY2xhc3NMaXN0LmFkZChib3QpOyovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyNUT0RPOiBzdGlsbCByZW1haW5pbmcgYmxvY2sgaXMgbm90IGZpbGxlZFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgICogZm9ybWF0IHdpbm5lciBvcmRlclxuICAgICovXG4gIGZ1bmN0aW9uIGZvcm1hdFdpbm5lcih3aW5uZXIpe1xuICAgIGlmKHdpbm5lclsxXT09d2lubmVyWzNdIHx8IHdpbm5lclsyXT09d2lubmVyWzRdKXsgLy9yb3cgb3IgY29sdW1uXG4gICAgICBmb3IodmFyIHI9d2lubmVyWzFdO3I8PXdpbm5lclszXTtyKyspe1xuICAgICAgICBmb3IodmFyIGM9d2lubmVyWzJdO2M8PXdpbm5lcls0XTtjKyspe1xuICAgICAgICAgIHZhciBibG9jaz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JcIiArIHIgKyBcImNcIiArIGMpO1xuICAgICAgICAgIGJsb2NrLmNsYXNzTGlzdC5hZGQoXCJ3aW5cIik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9ZWxzZSBpZih3aW5uZXJbMV09PTEgJiYgd2lubmVyWzJdPT0zKXsgLy9ib3R0b20gbGVmdCB0byB0b3AgcmlnaHRcbiAgICAgIGZvcih2YXIgaT0xO2k8NDtpKyspe1xuICAgICAgICB2YXIgYmxvY2s9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNyXCIgKyBpICsgXCJjXCIgKyAoNC1pKSk7XG4gICAgICAgIGJsb2NrLmNsYXNzTGlzdC5hZGQoXCJ3aW5cIik7XG4gICAgICB9XG4gICAgfWVsc2UgaWYod2lubmVyWzFdPT0xICYmIHdpbm5lclsyXT09MSl7IC8vdG9wIGxlZnQgdG8gYm90dG9tIHJpZ2h0XG4gICAgICBmb3IodmFyIGk9MTtpPDQ7aSsrKXtcbiAgICAgICAgdmFyIGJsb2NrPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjclwiICsgaSArIFwiY1wiICsgaSk7XG4gICAgICAgIGJsb2NrLmNsYXNzTGlzdC5hZGQoXCJ3aW5cIik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAgKiBsb29rIGZvciBwcm92aWRlZCBwYXR0ZXJzIGluIHRoZSBjdXJyZW50IHBvc2l0aW9uc1xuICAgICogYW5kIHJldHVybiBiZXN0IHNsb3QgdGhhdCBtYXRjaGVzIHRoZSBwYXR0ZXJuXG4gICAgKiByZXR1cm4gZmFsc2UgaWYgbm8gc3VjaCBtYXRjaFxuICAgICovXG4gIGZ1bmN0aW9uIGZpbGxOZXh0QmVzdFNsb3QocG9zaXRpb25zLHBhdHRlcm5zKXtcbiAgICAvL2xvb2sgZm9yIGNvbXBsZXRlZCByb3dzIG9yIGNvbHVtbnMgaW4gcG9zaXRpb25zXG4gICAgLy9yZXR1cm4gdGhlIHdpbm5lciBpZiBmb3VuZFxuICAgIGNvbnNvbGUubG9nKFwicGF0dGVybnM6IFwiICsgcGF0dGVybnMpO1xuICAgIHZhciByZXN1bHQ9ZmFsc2U7XG4gICAgZm9yKHZhciBpPTA7aTwzO2krKyl7XG4gICAgICB2YXIgY29sdW1uPXBvc2l0aW9uc1swXVtpXStwb3NpdGlvbnNbMV1baV0rcG9zaXRpb25zWzJdW2ldO1xuXG4gICAgICBpZihwYXR0ZXJucy5pbmNsdWRlcyhwb3NpdGlvbnNbaV0pKXtcbiAgICAgICAgYz1wb3NpdGlvbnNbaV0uaW5kZXhPZihcImJcIikrMTtcbiAgICAgICAgcj1pKzE7XG4gICAgICAgIHJlc3VsdD0gW3IsY107XG4gICAgICB9IGVsc2UgaWYocGF0dGVybnMuaW5jbHVkZXMoY29sdW1uKSl7XG4gICAgICAgIHI9Y29sdW1uLmluZGV4T2YoXCJiXCIpKzE7XG4gICAgICAgIGM9aSsxO1xuICAgICAgICByZXN1bHQ9IFtyLGNdO1xuICAgICAgfVxuICAgIH1cbiAgICAvKmlmKHJlc3VsdCl7XG4gICAgICBjb25zb2xlLmxvZyhcInJvdy9jb2wgcmVzdWx0OlwiICsgcmVzdWx0KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSovXG5cbiAgICAvL2NoZWNrIGZvciBjb21wbGV0ZWQgcG9zaXRpb25zIGRpYWdvbmFsbHlcbiAgICB2YXIgZGlhZzE9cG9zaXRpb25zWzBdWzBdK3Bvc2l0aW9uc1sxXVsxXStwb3NpdGlvbnNbMl1bMl07XG4gICAgdmFyIGRpYWcyPXBvc2l0aW9uc1swXVsyXStwb3NpdGlvbnNbMV1bMV0rcG9zaXRpb25zWzJdWzBdO1xuICAgIGlmKHBhdHRlcm5zLmluY2x1ZGVzKGRpYWcxKSl7XG4gICAgICB2YXIgaW5kZXg9ZGlhZzEuaW5kZXhPZihcImJcIik7XG4gICAgICByPWluZGV4KzE7XG4gICAgICBjPWluZGV4KzE7XG4gICAgICByZXN1bHQ9IFtyLGNdO1xuICAgIH0gZWxzZSBpZihwYXR0ZXJucy5pbmNsdWRlcyhkaWFnMikpe1xuICAgICAgdmFyIGluZGV4PWRpYWcyLmluZGV4T2YoXCJiXCIpO1xuICAgICAgYz0zLWluZGV4O1xuICAgICAgcj1pbmRleCsxO1xuICAgICAgcmVzdWx0PSBbcixjXTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coXCJhZnRlciBkaWFnb25hbCBjaGVjayByZXN1bHQ6XCIgKyByZXN1bHQpO1xuICAgIGlmKHJlc3VsdCl7XG4gICAgICBjb25zb2xlLmxvZyhcImZpbmRiZXN0c2xvdDp0cnlpbmcgdG8gZmlsbCBzbG90XCIpO1xuICAgICAgdmFyIG5leHRCbG9jaz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JcIityZXN1bHRbMF0rXCJjXCIrcmVzdWx0WzFdKTtcbiAgICAgIG5leHRCbG9jay5jbGFzc0xpc3QuYWRkKGJvdCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgZnVuY3Rpb24gZ2V0V2lubmVyKHBvc2l0aW9ucyl7XG4gICAgLy9sb29rIGZvciBjb21wbGV0ZWQgcm93cyBvciBjb2x1bW5zIGluIHBvc2l0aW9uc1xuICAgIC8vcmV0dXJuIHRoZSB3aW5uZXIgaWYgZm91bmRcbiAgICB2YXIgcmVzdWx0PWZhbHNlO1xuICAgIGZvcih2YXIgaT0wO2k8MztpKyspe1xuICAgICAgdmFyIGNvbHVtbj1wb3NpdGlvbnNbMF1baV0rcG9zaXRpb25zWzFdW2ldK3Bvc2l0aW9uc1syXVtpXTtcbiAgICAgIGlmKHBvc2l0aW9uc1tpXT09PVwieHh4XCIpe1xuICAgICAgICByZXN1bHQ9W1wieFwiLGkrMSwxLGkrMSwzXTtcbiAgICAgIH0gZWxzZSBpZihwb3NpdGlvbnNbaV09PT1cIm9vb1wiKXtcbiAgICAgICAgcmVzdWx0PVtcIm9cIixpKzEsMSxpKzEsM107XG4gICAgICB9IGVsc2UgaWYoY29sdW1uPT09XCJ4eHhcIikge1xuICAgICAgICByZXN1bHQ9W1wieFwiLDEsaSsxLDMsaSsxXTtcbiAgICAgIH0gZWxzZSBpZihjb2x1bW49PT1cIm9vb1wiKXtcbiAgICAgICAgcmVzdWx0PVtcIm9cIiwxLGkrMSwzLGkrMV07XG4gICAgICB9XG4gICAgICBpZihyZXN1bHQpXG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vY2hlY2sgZm9yIGNvbXBsZXRlZCBwb3NpdGlvbnMgZGlhZ29uYWxseVxuICAgIHZhciBkaWFnMT1wb3NpdGlvbnNbMF1bMF0rcG9zaXRpb25zWzFdWzFdK3Bvc2l0aW9uc1syXVsyXTtcbiAgICB2YXIgZGlhZzI9cG9zaXRpb25zWzBdWzJdK3Bvc2l0aW9uc1sxXVsxXStwb3NpdGlvbnNbMl1bMF07XG4gICAgaWYoIXJlc3VsdCl7XG4gICAgICBpZihkaWFnMT09PVwieHh4XCIpe1xuICAgICAgICByZXN1bHQ9W1wieFwiLDEsMSwzLDNdO1xuICAgICAgfWVsc2UgaWYgKGRpYWcyPT09XCJ4eHhcIil7XG4gICAgICAgIHJlc3VsdD1bXCJ4XCIsMSwzLDMsMV07XG4gICAgICB9ZWxzZSBpZihkaWFnMT09PVwib29vXCIpe1xuICAgICAgICByZXN1bHQ9W1wib1wiLDEsMSwzLDNdO1xuICAgICAgfWVsc2UgaWYoZGlhZzI9PT1cIm9vb1wiKXtcbiAgICAgICAgcmVzdWx0PVtcIjBcIiwxLDMsMywxXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBmdW5jdGlvbiBnZXRHYW1lUG9zaXRpb25zKCl7XG4gICAgdmFyIGdhbWVQb3NpdGlvbnM9W107XG4gICAgZm9yKHZhciBpPTE7aTw0O2krKyl7XG4gICAgICB2YXIgcm93PVwiXCI7XG4gICAgICBmb3IodmFyIGo9MTtqPDQ7aisrKXtcbiAgICAgICAgdmFyIHBvc2l0aW9uPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjclwiICsgaSArIFwiY1wiICsgaik7XG4gICAgICAgIGlmKHBvc2l0aW9uLmNsYXNzTGlzdC5jb250YWlucyhcInhcIikpXG4gICAgICAgICAgcm93Kz1cInhcIjtcbiAgICAgICAgZWxzZSBpZihwb3NpdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJvXCIpKVxuICAgICAgICAgIHJvdys9XCJvXCI7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICByb3crPVwiYlwiO1xuICAgICAgfVxuICAgICAgZ2FtZVBvc2l0aW9ucy5wdXNoKHJvdyk7XG4gICAgfVxuICAgIHJldHVybiBnYW1lUG9zaXRpb25zO1xuICB9O1xuXG4gIGZvcih2YXIgaT0wO2k8YnV0dG9ucy5sZW5ndGg7aSsrKXtcbiAgICBidXR0b25zW2ldLm9uY2xpY2s9YnV0dG9uQ2xpY2tIYW5kbGVyO1xuICB9XG5cbn1cbiJdfQ==
