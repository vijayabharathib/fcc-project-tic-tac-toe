function setupPlayerOption(){function o(){var o=Math.floor(3*Math.random())+1,e=Math.floor(3*Math.random())+1,r=document.querySelector("#r"+o+"c"+e);r.classList.add("x")}var e=function(){console.log("inside player choice"),bot=this.classList.contains("x")?"o":"x",player="x"===bot?"o":"x",console.log("bot:"+bot+";player:"+player);var e=document.querySelector(".game");e.classList.remove("off"),e.classList.add("on");var r=document.querySelector(".status");r.innerText="Game on","x"===bot&&o()},r=document.querySelectorAll(".player");r[0].onclick=e,r[1].onclick=e}function setupPlayerInput(){function o(o){if(o[1]==o[3]||o[2]==o[4])for(var e=o[1];e<=o[3];e++)for(var r=o[2];r<=o[4];r++){var t=document.querySelector("#r"+e+"c"+r);t.classList.add("win")}else if(1==o[1]&&3==o[2])for(var l=1;l<4;l++){var t=document.querySelector("#r"+l+"c"+(4-l));t.classList.add("win")}else if(1==o[1]&&1==o[2])for(var l=1;l<4;l++){var t=document.querySelector("#r"+l+"c"+l);t.classList.add("win")}}function e(o,e){console.log("patterns: "+e);for(var t=!1,l=0;l<3;l++){var a=o[0][l]+o[1][l]+o[2][l];e.includes(o[l])?(c=o[l].indexOf("b")+1,r=l+1,t=[r,c]):e.includes(a)&&(r=a.indexOf("b")+1,c=l+1,t=[r,c])}if(t)return console.log("row/col result:"+t),t;var n=o[0][0]+o[1][1]+o[2][2],s=o[0][2]+o[1][1]+o[2][0];if(console.log("diag1:"+n+";diag2:"+s),e.includes(n)){var i=n.indexOf("b");r=i+1,c=i+1,t=[r,c]}else if(e.includes(s)){var i=s.indexOf("b");c=3-i,r=i+1,t=[r,c]}return console.log("after diagonal check result:"+t),t}function t(o){for(var e=!1,r=0;r<3;r++){var t=o[0][r]+o[1][r]+o[2][r];if("xxx"===o[r]?e=["x",r+1,1,r+1,3]:"ooo"===o[r]?e=["o",r+1,1,r+1,3]:"xxx"===t?e=["x",1,r+1,3,r+1]:"ooo"===t&&(e=["o",1,r+1,3,r+1]),e)break}var l=o[0][0]+o[1][1]+o[2][2],a=o[0][2]+o[1][1]+o[2][0];return e||("xxx"===l?e=["x",1,1,3,3]:"xxx"===a?e=["x",1,3,3,1]:"ooo"===l?e=["o",1,1,3,3]:"ooo"===a&&(e=["0",1,3,3,1])),e}function l(){for(var o=[],e=1;e<4;e++){for(var r="",t=1;t<4;t++){var l=document.querySelector("#r"+e+"c"+t);r+=l.classList.contains("x")?"x":l.classList.contains("o")?"o":"b"}o.push(r)}return console.log(o),o}for(var a=document.querySelectorAll(".game button"),n=function(){var r=l(),a=t(r);if(a||this.classList.contains("x")||this.classList.contains("o")||this.classList.add(player),r=l(),a=t(r),console.log(a),a)return void o(a);var c=[bot+bot+"b",bot+"b"+bot,"b"+bot+bot],n=e(r,c);if(console.log("fill "+n+" to win."),n){var s=document.querySelector("#r"+n[0]+"c"+n[1]);if(s.classList.add(bot),r=l(),a=t(r),console.log("winner:"+a),a)return void o(a)}else{var i=[player+player+"b",player+"b"+player,"b"+player+player];if(n=e(r,i),console.log("fill "+n+" to defend"),n){var s=document.querySelector("#r"+n[0]+"c"+n[1]);s.classList.add(bot)}else{var u=[bot+"bb","bb"+bot,"b"+bot+"b"];if(n=e(r,u),console.log("fill "+n+" to position strategically"),n){var s=document.querySelector("#r"+n[0]+"c"+n[1]);s.classList.add(bot)}else{var d=[player+"bb","bb"+player,"b"+player+"b"];if(n=e(r,d),console.log("fill "+n+" to position strategically"),n){var s=document.querySelector("#r"+n[0]+"c"+n[1]);s.classList.add(bot)}}}}},s=0;s<a.length;s++)a[s].onclick=n}var player="b",bot="b";document.addEventListener("DOMContentLoaded",function(o){setupPlayerOption(),setupPlayerInput()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsic2V0dXBQbGF5ZXJPcHRpb24iLCJmaXJzdE1vdmUiLCJyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiYyIsInJhbmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjbGFzc0xpc3QiLCJhZGQiLCJwbGF5ZXJDaG9pY2UiLCJjb25zb2xlIiwibG9nIiwiYm90IiwidGhpcyIsImNvbnRhaW5zIiwicGxheWVyIiwiZ2FtZSIsInJlbW92ZSIsInN0YXR1cyIsImlubmVyVGV4dCIsInBsYXllck9wdGlvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwib25jbGljayIsInNldHVwUGxheWVySW5wdXQiLCJmb3JtYXRXaW5uZXIiLCJ3aW5uZXIiLCJibG9jayIsImkiLCJmaWxsIiwicG9zaXRpb25zIiwicGF0dGVybnMiLCJyZXN1bHQiLCJjb2x1bW4iLCJpbmNsdWRlcyIsImluZGV4T2YiLCJkaWFnMSIsImRpYWcyIiwiaW5kZXgiLCJnZXRXaW5uZXIiLCJnZXRHYW1lUG9zaXRpb25zIiwiZ2FtZVBvc2l0aW9ucyIsInJvdyIsImoiLCJwb3NpdGlvbiIsInB1c2giLCJidXR0b25zIiwiYnV0dG9uQ2xpY2tIYW5kbGVyIiwid2luUGF0dGVybnMiLCJuZXh0IiwibmV4dEJsb2NrIiwiZGVmZW5jZVBhdHRlcm5zIiwic3RyYXRlZ2ljV2luUGF0dGVybnMiLCJzdHJhdGVnaWNEZWZlbmNlUGF0dGVybnMiLCJsZW5ndGgiLCJhZGRFdmVudExpc3RlbmVyIiwiZSJdLCJtYXBwaW5ncyI6IkFBYUEsUUFBU0EscUJBZVAsUUFBU0MsS0FDUCxHQUFJQyxHQUFFQyxLQUFLQyxNQUFvQixFQUFkRCxLQUFLRSxVQUFZLEVBQzlCQyxFQUFFSCxLQUFLQyxNQUFvQixFQUFkRCxLQUFLRSxVQUFZLEVBQzlCRSxFQUFLQyxTQUFTQyxjQUFjLEtBQU1QLEVBQUksSUFBS0ksRUFDL0NDLEdBQUtHLFVBQVVDLElBQUksS0FsQnJCLEdBQUlDLEdBQWEs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c0IsR0FDcEJ6QyxRQUFRQyxJQUFJLFFBQVVxQyxFQUFPLDhCQUMxQkEsRUFBSyxDQUNOLEdBQUlDLEdBQVU1QyxTQUFTQyxjQUFjLEtBQUswQyxFQUFLLEdBQUcsSUFBSUEsRUFBSyxHQUMzREMsR0FBVTFDLFVBQVVDLElBQUlJLFNBQ3JCLENBQ0gsR0FBSXdDLElBQTBCckMsT0FBTyxLQUFLLEtBQUtBLE9BQU8sSUFBSUEsT0FBTyxJQUdqRSxJQUZBaUMsRUFBS3BCLEVBQUtDLEVBQVV1QixHQUNwQjFDLFFBQVFDLElBQUksUUFBVXFDLEVBQU8sOEJBQzFCQSxFQUFLLENBQ04sR0FBSUMsR0FBVTVDLFNBQVNDLGNBQWMsS0FBSzBDLEVBQUssR0FBRyxJQUFJQSxFQUFLLEdBQzNEQyxHQUFVMUMsVUFBVUMsSUFBSUksVUFxSTFCZSxFQUFFLEVBQUVBLEVBQUVrQixFQUFRUSxPQUFPMUIsSUFDM0JrQixFQUFRbEIsR0FBR0wsUUFBUXdCLEVBak9yQixHQUFJL0IsUUFBTyxJQUNQSCxJQUFJLEdBQ1ZQLFVBQVNpRCxpQkFBaUIsbUJBQW1CLFNBQVNDLEdBSXBEMUQsb0JBQ0EwQiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gICogd2FpdCB1bnRpbCB0aGUgZG9jIGlzIHJlYWR5IHRvIG9iZXkgb3JkZXJzXG4gICovXG4gIHZhciBwbGF5ZXI9XCJiXCI7XG4gIHZhciBib3Q9XCJiXCI7XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGZ1bmN0aW9uKGUpe1xuICAvKipcbiAgICAqIG9uY2UgY29udGVudCBpcyBsb2FkZWRcbiAgICAqL1xuICBzZXR1cFBsYXllck9wdGlvbigpO1xuICBzZXR1cFBsYXllcklucHV0KCk7XG59KTtcblxuZnVuY3Rpb24gc2V0dXBQbGF5ZXJPcHRpb24oKXtcbiAgdmFyIHBsYXllckNob2ljZT1mdW5jdGlvbigpe1xuICAgIGNvbnNvbGUubG9nKFwiaW5zaWRlIHBsYXllciBjaG9pY2VcIik7XG4gICAgYm90PSh0aGlzLmNsYXNzTGlzdC5jb250YWlucyhcInhcIikpID8gXCJvXCIgOiBcInhcIjtcbiAgICBwbGF5ZXI9KGJvdD09PVwieFwiKSA/IFwib1wiIDogXCJ4XCI7XG4gICAgY29uc29sZS5sb2coXCJib3Q6XCIgKyBib3QgKyBcIjtwbGF5ZXI6XCIgKyBwbGF5ZXIpO1xuICAgIHZhciBnYW1lPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYW1lJyk7XG4gICAgZ2FtZS5jbGFzc0xpc3QucmVtb3ZlKCdvZmYnKTtcbiAgICBnYW1lLmNsYXNzTGlzdC5hZGQoJ29uJyk7XG4gICAgdmFyIHN0YXR1cz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3RhdHVzJyk7XG4gICAgc3RhdHVzLmlubmVyVGV4dD1cIkdhbWUgb25cIjtcbiAgICBpZihib3Q9PT1cInhcIilcbiAgICAgIGZpcnN0TW92ZSgpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGZpcnN0TW92ZSgpe1xuICAgIHZhciByPU1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozKSsxO1xuICAgIHZhciBjPU1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozKSsxO1xuICAgIHZhciByYW5kPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjclwiKyByICsgXCJjXCIgK2MpO1xuICAgIHJhbmQuY2xhc3NMaXN0LmFkZChcInhcIik7XG4gIH07XG5cbiAgdmFyIHBsYXllck9wdGlvbnM9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXllcicpO1xuICBwbGF5ZXJPcHRpb25zWzBdLm9uY2xpY2s9cGxheWVyQ2hvaWNlO1xuICBwbGF5ZXJPcHRpb25zWzFdLm9uY2xpY2s9cGxheWVyQ2hvaWNlO1xuXG59XG5cbmZ1bmN0aW9uIHNldHVwUGxheWVySW5wdXQoKXtcbiAgdmFyIGJ1dHRvbnM9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5nYW1lIGJ1dHRvblwiKTtcbiAgdmFyIGJ1dHRvbkNsaWNrSGFuZGxlcj1mdW5jdGlvbigpe1xuICAgIHZhciBwb3NpdGlvbnM9Z2V0R2FtZVBvc2l0aW9ucygpO1xuICAgIHZhciB3aW5uZXI9Z2V0V2lubmVyKHBvc2l0aW9ucyk7XG4gICAgLy8gZG8gbm90aGluZyBpZiB0aGUgYmxvY2sgYWxyZWFkeSBoYXMgeCBvciBvIChhbmQgdGhlIGdhbWUgaXMgc3RpbGwgb24pXG4gICAgaWYoIXdpbm5lciAmJiAhdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoXCJ4XCIpICYmICF0aGlzLmNsYXNzTGlzdC5jb250YWlucyhcIm9cIikpe1xuICAgICAgdGhpcy5jbGFzc0xpc3QuYWRkKHBsYXllcik7XG4gICAgfVxuICAgIHBvc2l0aW9ucz1nZXRHYW1lUG9zaXRpb25zKCk7IC8vZ2V0IHBvc2l0aW9ucyBhZ2FpbiwgYmFzZWQgb24gbGFzdCB1c2VyIGlucHV0XG4gICAgd2lubmVyPWdldFdpbm5lcihwb3NpdGlvbnMpO1xuICAgIGNvbnNvbGUubG9nKHdpbm5lcik7XG4gICAgaWYod2lubmVyKXtcbiAgICAgIGZvcm1hdFdpbm5lcih3aW5uZXIpO1xuICAgICAgcmV0dXJuOyAvL2dhbWVvdmVyXG4gICAgfVxuXG4gICAgdmFyIHdpblBhdHRlcm5zPVtib3QrYm90K1wiYlwiLGJvdCtcImJcIitib3QsXCJiXCIrYm90K2JvdF07XG5cbiAgICAvL3RyeSB0byB3aW4gZmlyc3RcbiAgICB2YXIgbmV4dD1maWxsKHBvc2l0aW9ucyx3aW5QYXR0ZXJucyk7XG4gICAgY29uc29sZS5sb2coXCJmaWxsIFwiICsgbmV4dCArIFwiIHRvIHdpbi5cIik7XG4gICAgaWYobmV4dCl7XG4gICAgICB2YXIgbmV4dEJsb2NrPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjclwiK25leHRbMF0rXCJjXCIrbmV4dFsxXSk7XG4gICAgICBuZXh0QmxvY2suY2xhc3NMaXN0LmFkZChib3QpO1xuICAgICAgcG9zaXRpb25zPWdldEdhbWVQb3NpdGlvbnMoKTtcbiAgICAgIHdpbm5lcj1nZXRXaW5uZXIocG9zaXRpb25zKTtcbiAgICAgIGNvbnNvbGUubG9nKFwid2lubmVyOlwiK3dpbm5lcik7XG4gICAgICBpZih3aW5uZXIpe1xuICAgICAgICBmb3JtYXRXaW5uZXIod2lubmVyKTtcbiAgICAgICAgcmV0dXJuOyAvL2dhbWVvdmVyXG4gICAgICB9XG4gICAgfWVsc2V7XG4gICAgICAvL3NlY29uZCBpcyB0byB0cnkgYW5kIGRlZmVuZFxuICAgICAgdmFyIGRlZmVuY2VQYXR0ZXJucz1bcGxheWVyK3BsYXllcitcImJcIixwbGF5ZXIrXCJiXCIrcGxheWVyLFwiYlwiK3BsYXllcitwbGF5ZXJdO1xuICAgICAgbmV4dD1maWxsKHBvc2l0aW9ucyxkZWZlbmNlUGF0dGVybnMpO1xuICAgICAgY29uc29sZS5sb2coXCJmaWxsIFwiICsgbmV4dCArIFwiIHRvIGRlZmVuZFwiKTtcbiAgICAgIGlmKG5leHQpe1xuICAgICAgICB2YXIgbmV4dEJsb2NrPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjclwiK25leHRbMF0rXCJjXCIrbmV4dFsxXSk7XG4gICAgICAgIG5leHRCbG9jay5jbGFzc0xpc3QuYWRkKGJvdCk7XG4gICAgICB9ZWxzZXsgLy90aGlyZCwgdHJ5IHRvIHBvc2l0aW9uIGJvdCBzaWRlIGJ5IHNpZGUsIGluIHJlYWRpbmVzcyBmb3IgbmV4dCB3aW5cbiAgICAgICAgdmFyIHN0cmF0ZWdpY1dpblBhdHRlcm5zPVtib3QrXCJiYlwiLFwiYmJcIitib3QsXCJiXCIrYm90K1wiYlwiXTtcbiAgICAgICAgbmV4dD1maWxsKHBvc2l0aW9ucyxzdHJhdGVnaWNXaW5QYXR0ZXJucyk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZmlsbCBcIiArIG5leHQgKyBcIiB0byBwb3NpdGlvbiBzdHJhdGVnaWNhbGx5XCIpO1xuICAgICAgICBpZihuZXh0KXtcbiAgICAgICAgICB2YXIgbmV4dEJsb2NrPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjclwiK25leHRbMF0rXCJjXCIrbmV4dFsxXSk7XG4gICAgICAgICAgbmV4dEJsb2NrLmNsYXNzTGlzdC5hZGQoYm90KTtcbiAgICAgICAgfWVsc2V7IC8vbXVzdCBiZSBlYXJseSBzdGFnZXMsIHRyeSB0byBwb3NpdGlvbm4gcmlnaHQgbmV4dCB0byB0aGUgcGxheWVyXG4gICAgICAgICAgdmFyIHN0cmF0ZWdpY0RlZmVuY2VQYXR0ZXJucz1bcGxheWVyK1wiYmJcIixcImJiXCIrcGxheWVyLFwiYlwiK3BsYXllcitcImJcIl07XG4gICAgICAgICAgbmV4dD1maWxsKHBvc2l0aW9ucyxzdHJhdGVnaWNEZWZlbmNlUGF0dGVybnMpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiZmlsbCBcIiArIG5leHQgKyBcIiB0byBwb3NpdGlvbiBzdHJhdGVnaWNhbGx5XCIpO1xuICAgICAgICAgIGlmKG5leHQpe1xuICAgICAgICAgICAgdmFyIG5leHRCbG9jaz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JcIituZXh0WzBdK1wiY1wiK25leHRbMV0pO1xuICAgICAgICAgICAgbmV4dEJsb2NrLmNsYXNzTGlzdC5hZGQoYm90KTtcbiAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIC8vI1RPRE86IGp1c3QgZmlsbCB0aGUgcmVtYWluaW5nIGJsb2NrICwgaXQgbG9va3MgbGlrZSBhIHRpZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICB9O1xuXG4gIC8qKlxuICAgICogZm9ybWF0IHdpbm5lciBvcmRlclxuICAgICovXG4gIGZ1bmN0aW9uIGZvcm1hdFdpbm5lcih3aW5uZXIpe1xuICAgIGlmKHdpbm5lclsxXT09d2lubmVyWzNdIHx8IHdpbm5lclsyXT09d2lubmVyWzRdKXsgLy9yb3cgb3IgY29sdW1uXG4gICAgICBmb3IodmFyIHI9d2lubmVyWzFdO3I8PXdpbm5lclszXTtyKyspe1xuICAgICAgICBmb3IodmFyIGM9d2lubmVyWzJdO2M8PXdpbm5lcls0XTtjKyspe1xuICAgICAgICAgIHZhciBibG9jaz1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JcIiArIHIgKyBcImNcIiArIGMpO1xuICAgICAgICAgIGJsb2NrLmNsYXNzTGlzdC5hZGQoXCJ3aW5cIik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9ZWxzZSBpZih3aW5uZXJbMV09PTEgJiYgd2lubmVyWzJdPT0zKXsgLy9ib3R0b20gbGVmdCB0byB0b3AgcmlnaHRcbiAgICAgIGZvcih2YXIgaT0xO2k8NDtpKyspe1xuICAgICAgICB2YXIgYmxvY2s9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNyXCIgKyBpICsgXCJjXCIgKyAoNC1pKSk7XG4gICAgICAgIGJsb2NrLmNsYXNzTGlzdC5hZGQoXCJ3aW5cIik7XG4gICAgICB9XG4gICAgfWVsc2UgaWYod2lubmVyWzFdPT0xICYmIHdpbm5lclsyXT09MSl7IC8vdG9wIGxlZnQgdG8gYm90dG9tIHJpZ2h0XG4gICAgICBmb3IodmFyIGk9MTtpPDQ7aSsrKXtcbiAgICAgICAgdmFyIGJsb2NrPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjclwiICsgaSArIFwiY1wiICsgaSk7XG4gICAgICAgIGJsb2NrLmNsYXNzTGlzdC5hZGQoXCJ3aW5cIik7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAgKiBUcnkgdG8gd2luIGZpcnN0IChsb29rIGZvciB0d28gY29uc2VjdXRpdmUgYm90IG9wdGlvbnMgYW5kIGZpbGwgaW4gdGhlIHRoaXJkKVxuICAgICovXG4gIGZ1bmN0aW9uIGZpbGwocG9zaXRpb25zLHBhdHRlcm5zKXtcbiAgICAvL2xvb2sgZm9yIGNvbXBsZXRlZCByb3dzIG9yIGNvbHVtbnMgaW4gcG9zaXRpb25zXG4gICAgLy9yZXR1cm4gdGhlIHdpbm5lciBpZiBmb3VuZFxuICAgIGNvbnNvbGUubG9nKFwicGF0dGVybnM6IFwiICsgcGF0dGVybnMpO1xuICAgIHZhciByZXN1bHQ9ZmFsc2U7XG4gICAgZm9yKHZhciBpPTA7aTwzO2krKyl7XG4gICAgICB2YXIgY29sdW1uPXBvc2l0aW9uc1swXVtpXStwb3NpdGlvbnNbMV1baV0rcG9zaXRpb25zWzJdW2ldO1xuXG4gICAgICBpZihwYXR0ZXJucy5pbmNsdWRlcyhwb3NpdGlvbnNbaV0pKXtcbiAgICAgICAgYz1wb3NpdGlvbnNbaV0uaW5kZXhPZihcImJcIikrMTtcbiAgICAgICAgcj1pKzE7XG4gICAgICAgIHJlc3VsdD0gW3IsY107XG4gICAgICB9IGVsc2UgaWYocGF0dGVybnMuaW5jbHVkZXMoY29sdW1uKSl7XG4gICAgICAgIHI9Y29sdW1uLmluZGV4T2YoXCJiXCIpKzE7XG4gICAgICAgIGM9aSsxO1xuICAgICAgICByZXN1bHQ9IFtyLGNdO1xuICAgICAgfVxuICAgIH1cbiAgICBpZihyZXN1bHQpe1xuICAgICAgY29uc29sZS5sb2coXCJyb3cvY29sIHJlc3VsdDpcIiArIHJlc3VsdCk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICAvL2NoZWNrIGZvciBjb21wbGV0ZWQgcG9zaXRpb25zIGRpYWdvbmFsbHlcbiAgICB2YXIgZGlhZzE9cG9zaXRpb25zWzBdWzBdK3Bvc2l0aW9uc1sxXVsxXStwb3NpdGlvbnNbMl1bMl07XG4gICAgdmFyIGRpYWcyPXBvc2l0aW9uc1swXVsyXStwb3NpdGlvbnNbMV1bMV0rcG9zaXRpb25zWzJdWzBdO1xuICAgIGNvbnNvbGUubG9nKFwiZGlhZzE6XCIrZGlhZzErXCI7ZGlhZzI6XCIrZGlhZzIpO1xuICAgIGlmKHBhdHRlcm5zLmluY2x1ZGVzKGRpYWcxKSl7XG4gICAgICB2YXIgaW5kZXg9ZGlhZzEuaW5kZXhPZihcImJcIik7XG4gICAgICByPWluZGV4KzE7XG4gICAgICBjPWluZGV4KzE7XG4gICAgICByZXN1bHQ9IFtyLGNdO1xuICAgIH0gZWxzZSBpZihwYXR0ZXJucy5pbmNsdWRlcyhkaWFnMikpe1xuICAgICAgdmFyIGluZGV4PWRpYWcyLmluZGV4T2YoXCJiXCIpO1xuICAgICAgYz0zLWluZGV4O1xuICAgICAgcj1pbmRleCsxO1xuICAgICAgcmVzdWx0PSBbcixjXTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coXCJhZnRlciBkaWFnb25hbCBjaGVjayByZXN1bHQ6XCIgKyByZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgZnVuY3Rpb24gZ2V0V2lubmVyKHBvc2l0aW9ucyl7XG4gICAgLy9sb29rIGZvciBjb21wbGV0ZWQgcm93cyBvciBjb2x1bW5zIGluIHBvc2l0aW9uc1xuICAgIC8vcmV0dXJuIHRoZSB3aW5uZXIgaWYgZm91bmRcbiAgICB2YXIgcmVzdWx0PWZhbHNlO1xuICAgIGZvcih2YXIgaT0wO2k8MztpKyspe1xuICAgICAgdmFyIGNvbHVtbj1wb3NpdGlvbnNbMF1baV0rcG9zaXRpb25zWzFdW2ldK3Bvc2l0aW9uc1syXVtpXTtcbiAgICAgIGlmKHBvc2l0aW9uc1tpXT09PVwieHh4XCIpe1xuICAgICAgICByZXN1bHQ9W1wieFwiLGkrMSwxLGkrMSwzXTtcbiAgICAgIH0gZWxzZSBpZihwb3NpdGlvbnNbaV09PT1cIm9vb1wiKXtcbiAgICAgICAgcmVzdWx0PVtcIm9cIixpKzEsMSxpKzEsM107XG4gICAgICB9IGVsc2UgaWYoY29sdW1uPT09XCJ4eHhcIikge1xuICAgICAgICByZXN1bHQ9W1wieFwiLDEsaSsxLDMsaSsxXTtcbiAgICAgIH0gZWxzZSBpZihjb2x1bW49PT1cIm9vb1wiKXtcbiAgICAgICAgcmVzdWx0PVtcIm9cIiwxLGkrMSwzLGkrMV07XG4gICAgICB9XG4gICAgICBpZihyZXN1bHQpXG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vY2hlY2sgZm9yIGNvbXBsZXRlZCBwb3NpdGlvbnMgZGlhZ29uYWxseVxuICAgIHZhciBkaWFnMT1wb3NpdGlvbnNbMF1bMF0rcG9zaXRpb25zWzFdWzFdK3Bvc2l0aW9uc1syXVsyXTtcbiAgICB2YXIgZGlhZzI9cG9zaXRpb25zWzBdWzJdK3Bvc2l0aW9uc1sxXVsxXStwb3NpdGlvbnNbMl1bMF07XG4gICAgaWYoIXJlc3VsdCl7XG4gICAgICBpZihkaWFnMT09PVwieHh4XCIpe1xuICAgICAgICByZXN1bHQ9W1wieFwiLDEsMSwzLDNdO1xuICAgICAgfWVsc2UgaWYgKGRpYWcyPT09XCJ4eHhcIil7XG4gICAgICAgIHJlc3VsdD1bXCJ4XCIsMSwzLDMsMV07XG4gICAgICB9ZWxzZSBpZihkaWFnMT09PVwib29vXCIpe1xuICAgICAgICByZXN1bHQ9W1wib1wiLDEsMSwzLDNdO1xuICAgICAgfWVsc2UgaWYoZGlhZzI9PT1cIm9vb1wiKXtcbiAgICAgICAgcmVzdWx0PVtcIjBcIiwxLDMsMywxXTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBmdW5jdGlvbiBnZXRHYW1lUG9zaXRpb25zKCl7XG4gICAgdmFyIGdhbWVQb3NpdGlvbnM9W107XG4gICAgZm9yKHZhciBpPTE7aTw0O2krKyl7XG4gICAgICB2YXIgcm93PVwiXCI7XG4gICAgICBmb3IodmFyIGo9MTtqPDQ7aisrKXtcbiAgICAgICAgdmFyIHBvc2l0aW9uPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjclwiICsgaSArIFwiY1wiICsgaik7XG4gICAgICAgIGlmKHBvc2l0aW9uLmNsYXNzTGlzdC5jb250YWlucyhcInhcIikpXG4gICAgICAgICAgcm93Kz1cInhcIjtcbiAgICAgICAgZWxzZSBpZihwb3NpdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJvXCIpKVxuICAgICAgICAgIHJvdys9XCJvXCI7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICByb3crPVwiYlwiO1xuICAgICAgfVxuICAgICAgZ2FtZVBvc2l0aW9ucy5wdXNoKHJvdyk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGdhbWVQb3NpdGlvbnMpO1xuICAgIHJldHVybiBnYW1lUG9zaXRpb25zO1xuICB9O1xuXG4gIGZvcih2YXIgaT0wO2k8YnV0dG9ucy5sZW5ndGg7aSsrKXtcbiAgICBidXR0b25zW2ldLm9uY2xpY2s9YnV0dG9uQ2xpY2tIYW5kbGVyO1xuICB9XG5cbn1cbiJdfQ==
